# 簡易ローグライクゲーム - 開発メモリ

## プロジェクト概要

ブラウザで動作するシンプルなローグライクゲーム。オールドスクールなローグライクゲームのエッセンスを抽出した簡易的な実装。

## 技術スタック

- **フロントエンド**: Vanilla JavaScript
- **スタイリング**: Tailwind CSS (CDN)
- **フォント**: M PLUS 1 Code (Google Fonts)
- **ビルドツール**: なし（静的HTML/JS/CSS）

## ファイル構成

```
web-tiny-rogue-like-gemini/
├── index.html      # メインHTML（UIレイアウト）
├── game.js         # ゲームロジック全般
├── styles.css      # カスタムスタイル
├── README.md       # プロジェクト説明書
├── CLAUDE.md       # 開発メモリ（このファイル）
└── .gitignore      # Git除外設定
```

## 実装済み機能

### 基本機能
- ランダムなダンジョン生成（部屋と通路）
- プレイヤーの移動（キーボード/タッチ操作）
- モンスターとの戦闘システム
- アイテム（ポーション）による回復
- 階層システム（階段で次の階へ）
- ゲームオーバー/リスタート機能

### 2024年改良点
1. **ファイル分離** (2024年7月)
   - JavaScriptとCSSを独立ファイルに分離
   - メンテナンス性の向上

2. **敵キャラクターの多様化** (2024年7月)
   - 4種類の敵を実装：
     - スライム（s）: HP2、ダメージ1、1階から
     - ゴブリン（g）: HP3、ダメージ1、2階から  
     - オーク（o）: HP5、ダメージ2、4階から
     - ドラゴン（D）: HP10、ダメージ3、7階から
   - 階層に応じた出現ロジック

## コードの重要な部分

### ゲーム状態管理
- `gameOver`: ゲーム終了フラグ
- `floor`: 現在の階層
- `turn`: 経過ターン数
- `player`: プレイヤー情報（位置、HP）
- `monsters`: モンスター配列
- `items`: アイテム配列

### 主要関数
- `generateMap()`: ダンジョン生成
- `drawMap()`: マップ描画
- `movePlayer()`: プレイヤー移動
- `attack()`: 戦闘処理
- `selectEnemyType()`: 階層に応じた敵選択

## 推奨される今後の改善案

### 優先度：高
1. **戦闘システムの深化**
   - ダメージの変動（例：1-3のランダムダメージ）
   - クリティカルヒットの実装
   - 防御力の概念追加
   - ミス/回避の可能性

2. **スコアシステム**
   - 倒した敵の数をカウント
   - 到達階層×倒した敵でスコア計算
   - localStorageでハイスコア保存
   - スコアランキング表示

3. **アイテムの多様化**
   - 武器（剣：攻撃力+1、斧：攻撃力+2）
   - 防具（盾：防御力+1）
   - 特殊ポーション（大回復、一時的強化）

### 優先度：中
4. **視界システム**
   - プレイヤーの視界範囲を制限（例：半径5マス）
   - 未探索エリアを暗く表示
   - 松明アイテムで視界拡大

5. **ダンジョン生成の改良**
   - 特殊な部屋（宝物庫、罠部屋、ボス部屋）
   - より自然な通路生成アルゴリズム
   - 階層ごとのテーマ（洞窟、遺跡、城など）

6. **UI/UXの改善**
   - アニメーション効果（移動、攻撃）
   - ダメージ数値の表示
   - ミニマップ機能
   - キーボードショートカットの説明

### 優先度：低
7. **音響効果**
   - 攻撃音、アイテム取得音
   - 階層ごとのBGM
   - 音量調整機能

8. **永続的な進行要素**
   - 経験値とレベルシステム
   - アンロック要素（新キャラクター、新アイテム）
   - 実績システム

9. **マルチプレイヤー要素**
   - デイリーチャレンジ（同じシード値）
   - リプレイ機能
   - スコア共有機能

## 実装時の注意点

1. **パフォーマンス**
   - 現在は小規模なため問題ないが、機能追加時は描画処理の最適化を検討
   - 大量のモンスター処理時のパフォーマンスに注意

2. **モバイル対応**
   - タッチ操作は実装済みだが、画面サイズによってはUIの調整が必要
   - 仮想キーパッドの位置やサイズの最適化

3. **ブラウザ互換性**
   - 現代的なブラウザを想定しているが、古いブラウザでの動作確認
   - ES6の機能を使用しているため、必要に応じてトランスパイルを検討

4. **セーブ機能**
   - 現在はセーブ機能なし
   - localStorageを使用した簡易セーブの実装を推奨

## デバッグ用コマンド

開発者コンソールで使用可能：
```javascript
// プレイヤーのHP回復
player.hp = player.maxHp;
drawAll();

// 次の階層へ
nextFloor();

// モンスターを全滅
monsters = [];
drawAll();
```

## リンクとリソース

- [Tailwind CSS](https://tailwindcss.com/)
- [ローグライクゲームの歴史](https://ja.wikipedia.org/wiki/ローグライクゲーム)
- [プロシージャル生成アルゴリズム](http://www.roguebasin.com/index.php?title=Dungeon-Building_Algorithm)

---

最終更新: 2024年7月30日